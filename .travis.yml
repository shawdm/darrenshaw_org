language: ruby
rvm:
- 2.6
before_script:
- chmod +x ./script/cibuild
script: "./script/cibuild"
env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true
addons:
  apt:
    packages:
    - libcurl4-openssl-dev
sudo: false
before_install:
- gem install bundler
deploy:
  - provider: s3
    skip_cleanup: true
    region: us-east-1
    provider: s3
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    bucket: www.darrenshaw.org
    local-dir: _site
    on:
      repo: shawdm/darrenshaw_org
      branch: master